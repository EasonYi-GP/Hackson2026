<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>半杯诗社</title>
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Serif+SC:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Rubik+Wet+Paint&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
             theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Noto Serif SC', 'serif'],
                        display: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        slate: { 850: '#151e32' }
                    }
                }
            }
        }
    </script>

    <style>
        /* 全局隐藏所有滚动条 */
        * {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
        }
        *::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
            width: 0;
            height: 0;
        }

        body { font-family: 'Inter', sans-serif; }
        .serif-font { font-family: 'Noto Serif SC', serif; }
        .liquid-font { font-family: 'Rubik Wet Paint', cursive; }

        .hide-scroll::-webkit-scrollbar { width: 4px; }
        .hide-scroll::-webkit-scrollbar-track { background: transparent; }
        .hide-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 2px; }

        /* 深渊背景 */
        .abyssal-bg {
            background-color: #020617;
            background-image:
                radial-gradient(circle at 15% 50%, rgba(30, 27, 75, 0.4) 0%, transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(15, 23, 42, 0.6) 0%, transparent 25%);
            min-height: 100vh;
        }

        /* 玻璃面板 */
        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.03);
            border-radius: 20px;
        }

        /* Dynamic Background */
        .mystic-bg {
            background-color: #020617;
            background-image:
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%),
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%),
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
            position: absolute; inset: 0; z-index: -1;
        }

        /* Glassmorphism Panel */
        .glass-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5);
        }

        .bubble {
            position: absolute;
            bottom: 0;
            background: radial-gradient(circle at 30% 30%, rgba(167, 139, 250, 0.7), rgba(139, 92, 246, 0.5));
            border-radius: 50%;
            animation: floatUpLazy ease-in-out infinite;
            pointer-events: none;
            box-shadow:
                inset 0 0 25px rgba(167, 139, 250, 0.6),
                0 0 40px rgba(139, 92, 246, 0.5),
                0 0 60px rgba(167, 139, 250, 0.3);
            backdrop-filter: blur(4px);
            border: 2px solid rgba(167, 139, 250, 0.6);
        }
        @keyframes floatUpLazy {
            0% { transform: translateY(0) translateX(0); opacity: 0; }
            5% { opacity: 0.85; }
            50% { opacity: 0.95; transform: translateY(-50vh) translateX(var(--drift)); }
            95% { opacity: 0.8; }
            100% { transform: translateY(-100vh) translateX(calc(var(--drift) * 1.5)); opacity: 0; }
        }

        /* 圈子卡片 */
        .vibe-card { transition: all 0.3s ease; }
        
        @keyframes border-glow {
            0%, 100% { 
                border-color: rgba(99, 102, 241, 0.5); 
                box-shadow: 0 0 15px rgba(99, 102, 241, 0.2) inset, 0 0 5px rgba(99, 102, 241, 0.3); 
            }
            50% { 
                border-color: rgba(139, 92, 246, 0.9); 
                box-shadow: 0 0 30px rgba(139, 92, 246, 0.4) inset, 0 0 20px rgba(139, 92, 246, 0.5); 
            }
        }

        .vibe-active {
            background: linear-gradient(135deg, rgba(67, 56, 202, 0.5), rgba(15, 23, 42, 0.95));
            border: 1px solid rgba(99, 102, 241, 0.6);
            animation: border-glow 2.5s infinite ease-in-out;
            position: relative;
            overflow: hidden;
            transform: scale(1.02);
            z-index: 10;
        }
        .vibe-active::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 80%; 
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
            transform: skewX(-25deg);
            animation: shine 4s infinite linear;
        }
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 200%; }
        }

        .vibe-active:hover {
            border-color: rgba(99, 102, 241, 0.8);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }
        .vibe-inactive {
            background: rgba(2, 6, 23, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.02);
            opacity: 0.5;
        }
    </style>
</head>
<body class="text-slate-200 min-h-screen relative font-sans overflow-x-hidden">

    <div class="mystic-bg"></div>

    <div class="relative z-10 flex flex-col md:flex-row min-h-screen p-2 md:p-4 gap-4 max-w-7xl mx-auto">
        <!-- 左侧导航栏 -->
        <aside class="glass-panel w-full lg:w-64 flex flex-col p-6 shadow-2xl shrink-0 lg:h-[calc(100vh-2rem)] lg:sticky lg:top-4">
            <div class="mb-8 flex lg:block items-center justify-between">
                <div>
                    <p class="text-[10px] text-amber-700/80 tracking-[0.3em] font-bold">EST. 2026</p>
                    <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-br from-amber-100 to-amber-600 serif-font mt-1">
                        半杯诗社
                    </h1>
                </div>
                <!-- Mobile Menu Button (Mock) -->
                <button class="lg:hidden text-slate-400"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg></button>
            </div>

            <!-- Nav (Hide on mobile for simplicity in this demo) -->
            <nav class="hidden lg:flex flex-col gap-2 flex-1">
                <a href="1.html" class="flex items-center gap-3 px-4 py-3 bg-white/5 text-amber-50 rounded-xl border border-white/5 font-medium transition-all group">
                    <svg class="w-5 h-5 text-amber-500/80" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                    <span>大厅 Hall</span>
                </a>
                <a href="2.html" class="flex items-center gap-3 px-4 py-3 text-slate-500 hover:text-slate-300 hover:bg-white/5 rounded-xl transition-all group">
                    <svg class="w-5 h-5 group-hover:text-amber-500/50 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                    <span>新人向导 Guide</span>
                </a>
                <a href="3.html" class="flex items-center gap-3 px-4 py-3 text-slate-500 hover:text-slate-300 hover:bg-white/5 rounded-xl transition-all group">
                    <svg class="w-5 h-5 group-hover:text-amber-500/50 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>
                    <span>微醺会话 Session</span>
                </a>
                <a href="4.html" class="flex items-center gap-3 px-4 py-3 text-slate-500 hover:text-slate-300 hover:bg-white/5 rounded-xl transition-all group">
                    <svg class="w-5 h-5 group-hover:text-amber-500/50 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                    <span>圈子 Circles</span>
                </a>
                <a href="6.html" class="flex items-center gap-3 px-4 py-3 text-slate-500 hover:text-slate-300 hover:bg-white/5 rounded-xl transition-all group">
                    <svg class="w-5 h-5 group-hover:text-amber-500/50 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    <span>我的档案 Profile</span>
                </a>
            </nav>

            <!-- 用户信息 -->
            <div class="hidden lg:flex mt-auto pt-6 border-t border-white/5 items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-amber-900/30 border border-amber-500/20 flex items-center justify-center text-amber-500 font-bold text-xs ring-4 ring-black">
                    ME
                </div>
                <div>
                    <p class="text-sm text-amber-500/80 font-bold">酒客 #0608</p>
                    <p class="text-[10px] text-slate-500">微醺探险家</p>
                </div>
            </div>
        </aside>

        <!-- 中间主内容区 -->
        <main class="flex-1 flex flex-col gap-6 min-w-0 lg:h-[calc(100vh-2rem)] lg:sticky lg:top-4 overflow-hidden">

            <!-- Search & Banner -->
            <div class="glass-panel p-5 flex flex-col md:flex-row justify-between items-center gap-4 border-l-4 border-l-amber-600/50 shrink-0">
                <div class="serif-font text-lg text-slate-400">
                    寻找属于你的 <span class="text-amber-500 italic font-bold">Vibe</span>
                </div>
                <!-- Search Input -->
                <div class="relative w-full md:w-1/3">
                    <input type="text" placeholder="Search drinks..." class="w-full bg-black/40 border border-white/5 rounded-full py-2 pl-4 pr-10 text-sm focus:outline-none focus:border-amber-500/30 text-slate-300 placeholder-slate-600">
                    <svg class="w-4 h-4 absolute right-3 top-2.5 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </div>
            </div>

            <!-- 模块1: 味友圈子 -->
            <div class="flex-1 flex flex-col overflow-hidden">
                <div class="flex items-center justify-between mb-4 px-1 shrink-0">
                    <h2 class="text-2xl font-bold serif-font text-slate-200 flex items-center gap-3">
                        实时圈子
                        <span class="text-[11px] text-slate-500 font-sans tracking-wider uppercase font-normal">Live Social Circles</span>
                    </h2>
                    <div class="flex items-center gap-2 text-xs text-slate-500">
                        <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                        <span>6 个圈子在线</span>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-6 flex-1" id="vibeContainer">
                    <!-- JS Injected -->
                </div>
            </div>


        </main>

        <!-- 右侧面板 (Right Panel) -->
        <!-- 改为 flex-col，并不再 fixed，而是在布局流中。 lg:w-80 -->
        <aside class="glass-panel w-full lg:w-80 flex flex-col shadow-2xl shrink-0 lg:h-[calc(100vh-2rem)] lg:sticky lg:top-4 overflow-hidden">
            <div class="p-5 border-b border-white/5 bg-black/20">
                <h2 class="text-lg font-bold serif-font text-amber-500/90 flex items-center gap-2">
                   <span class="w-2 h-2 rounded-full bg-amber-500 animate-pulse"></span>
                   酒水菜单
                </h2>
                <p class="text-[10px] text-slate-600 mt-1 uppercase tracking-wider">Select your drinks</p>
            </div>

            <!-- Categories -->
            <div class="border-b border-white/5 bg-black/5">
                 <div id="categoryContainer" class="flex overflow-x-auto no-scrollbar"></div>
            </div>

            <!-- 列表区域滚动 -->
            <div class="flex-1 overflow-y-auto hide-scroll p-4 space-y-2 h-[400px] lg:h-auto" id="productList">
                <!-- JS Injected -->
            </div>

            <!-- Cart Details Area -->
            <div id="cartDetails" class="hidden flex-col gap-2 p-4 bg-black/20 border-t border-white/5 max-h-48 overflow-y-auto">
            </div>

            <!-- 底部购物车悬浮条 -->
            <div class="p-4 bg-black/40 border-t border-white/10 backdrop-blur-md">
                <button id="checkoutBtn" onclick="checkout()" class="w-full bg-gradient-to-r from-amber-700 to-amber-600 hover:from-amber-600 hover:to-amber-500 text-amber-50 py-3 rounded-xl font-bold shadow-lg shadow-black/50 transition-all active:scale-95 flex justify-between px-6 items-center group">
                    <span class="flex items-center gap-2 text-sm">
                        <svg class="w-4 h-4 text-amber-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                        总金额
                    </span>
                    <span id="cartTotal" class="font-mono group-hover:text-white transition-colors">¥0.00</span>
                </button>
            </div>
        </aside>

    </div>

    <!-- FontAwesome for Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <script>
        // Data
        const vibes = [
            { id: "poetic", name: "微醺诗人", sub: "Poetic Drunk", users: 5, active: true },
            { id: "electro", name: "燥热电音", sub: "Electro Pulse", users: 0, active: false },
            { id: "whisper", name: "商务洽谈", sub: "Whisper Talks", users: 2, active: true },
            { id: "solo", name: "独自放空", sub: "Solo Chill", users: 1, active: false },
            { id: "gamer", name: "游戏人生", sub: "Gamer Life", users: 3, active: true }, // New
            { id: "foodie", name: "美食探店", sub: "Foodie Club", users: 0, active: true } // New
        ];

        // 4.html style Categorized Menu Data
        const MENU_CATEGORIES = [
            { id: 'beer', name: '啤酒 (Beer)', icon: 'fa-beer-mug-empty' },
            { id: 'cocktail', name: '鸡尾酒 (Cocktail)', icon: 'fa-martini-glass-citrus' },
            { id: 'liquor', name: '洋酒 (Liquor)', icon: 'fa-whiskey-glass' },
            { id: 'soft', name: '软饮 (Soft)', icon: 'fa-glass-water' },
            { id: 'snack', name: '小食 (Snack)', icon: 'fa-burger' }
        ];

        const allDrinks = [
             // Beer
             { id: 'b1', cat: 'beer', name: '精酿 IPA', price: 58, icon: 'fa-beer-mug-empty' },
             { id: 'b2', cat: 'beer', name: '桂花小麦 (Osmanthus)', price: 48, icon: 'fa-wheat-awn' },
             { id: 'b3', cat: 'beer', name: '科罗娜 (Corona)', price: 35, icon: 'fa-bottle-water' },
             { id: 'b4', cat: 'beer', name: '福佳白 (Hoegaarden)', price: 35, icon: 'fa-beer-mug-empty' },
             { id: 'b5', cat: 'beer', name: '1664 Blanc', price: 38, icon: 'fa-bottle-droplet' }, 
             { id: 'b6', cat: 'beer', name: '麒麟生啤 (Draft)', price: 30, icon: 'fa-beer-mug-empty' },
             { id: 'b7', cat: 'beer', name: '青岛纯生 (Tsingtao)', price: 28, icon: 'fa-bottle-droplet' },
             { id: 'b8', cat: 'beer', name: '朝日 (Asahi)', price: 30, icon: 'fa-beer-mug-empty'},
             { id: 'b9', cat: 'beer', name: '精酿世涛 (Stout)', price: 68, icon: 'fa-beer-mug-empty' },
             { id: 'b10', cat: 'beer', name: '百威 (Budweiser)', price: 30, icon: 'fa-beer-mug-empty' },
             { id: 'b11', cat: 'beer', name: '修道院啤酒 (Trappist)', price: 78, icon: 'fa-church' },
             { id: 'b12', cat: 'beer', name: '白熊 (Vedett)', price: 35, icon: 'fa-paw' },

             // Cocktails
             { id: 'c1', cat: 'cocktail', name: '特调·月光 (Moonlight)', price: 48, icon: 'fa-martini-glass' },
             { id: 'c2', cat: 'cocktail', name: '诗人之血 (Poet\'s Blood)', price: 55, icon: 'fa-droplet' },
             { id: 'c3', cat: 'cocktail', name: '星空 (Starry Night)', price: 62, icon: 'fa-star' },
             { id: 'c4', cat: 'cocktail', name: '野格炸弹 (Jager Bomb)', price: 58, icon: 'fa-bomb' },
             { id: 'c5', cat: 'cocktail', name: '长岛冰茶 (Long Island)', price: 65, icon: 'fa-glass-citrus' },
             { id: 'c6', cat: 'cocktail', name: '马提尼 (Dry Martini)', price: 88, icon: 'fa-martini-glass-citrus'},
             { id: 'c7', cat: 'cocktail', name: '莫吉托 (Mojito)', price: 48, icon: 'fa-leaf' },
             { id: 'c8', cat: 'cocktail', name: '日出龙舌兰 (Tequila Sunrise)', price: 52, icon: 'fa-sun' },
             { id: 'c9', cat: 'cocktail', name: '金汤力 (Gin Tonic)', price: 45, icon: 'fa-lemon' },
             { id: 'c10', cat: 'cocktail', name: 'B-52 轰炸机', price: 58, icon: 'fa-jet-fighter' },
             { id: 'c11', cat: 'cocktail', name: '尼格罗尼 (Negroni)', price: 88, icon: 'fa-glass-citrus' },
             { id: 'c12', cat: 'cocktail', name: '伏特加红牛 (Vodka RedBull)', price: 52, icon: 'fa-bull' },
             { id: 'c13', cat: 'cocktail', name: '曼哈顿 (Manhattan)', price: 98, icon: 'fa-city' },

             // Liquor
             { id: 'l1', cat: 'liquor', name: '苦艾酒 (Absinthe)', price: 68, icon: 'fa-cannabis' },
             { id: 'l2', cat: 'liquor', name: '红酒 (House Wine)', price: 42, icon: 'fa-wine-glass' },
             { id: 'l3', cat: 'liquor', name: 'Shot Tray (6 cups)', price: 188, icon: 'fa-glass-water-droplet' },
             { id: 'l4', cat: 'liquor', name: '单一麦芽 (Single Malt)', price: 128, icon: 'fa-whiskey-glass' },
             { id: 'l5', cat: 'liquor', name: '黑方 (Black Label)', price: 580, icon: 'fa-whiskey-glass' },
             { id: 'l6', cat: 'liquor', name: '杰克丹尼 (Jack Daniels)', price: 480, icon: 'fa-wine-bottle' },
             { id: 'l7', cat: 'liquor', name: '干邑 (Cognac)', price: 158, icon: 'fa-wine-glass-empty'},
             { id: 'l8', cat: 'liquor', name: '茅台 (Moutai)', price: 288, icon: 'fa-wine-bottle'},
             { id: 'l9', cat: 'liquor', name: '雪莉桶 (Sherry Cask)', price: 168, icon: 'fa-wine-glass' },
             { id: 'l10', cat: 'liquor', name: '皇家礼炮 (Royal Salute)', price: 888, icon: 'fa-crown' },
             { id: 'l11', cat: 'liquor', name: '百利甜 (Baileys)', price: 48, icon: 'fa-glass-water' },
             { id: 'l12', cat: 'liquor', name: '梅子酒 (Plum)', price: 42, icon: 'fa-wine-bottle' },

             // Soft
             { id: 's1', cat: 'soft', name: '热茶 (Hot Tea)', price: 28, icon: 'fa-mug-hot' },
             { id: 's2', cat: 'soft', name: '巴黎水 (Perrier)', price: 38, icon: 'fa-bottle-water'},
             { id: 's3', cat: 'soft', name: '热红酒 (Mulled Wine)', price: 45, icon: 'fa-mug-hot'},
             { id: 's4', cat: 'soft', name: '橙汁 (Juice)', price: 32, icon: 'fa-glass-water' },
             { id: 's5', cat: 'soft', name: '热牛奶 (Milk)', price: 28, icon: 'fa-mug-saucer' },
             { id: 's6', cat: 'soft', name: '可乐 (Coke)', price: 25, icon: 'fa-bottle-droplet' },
             { id: 's7', cat: 'soft', name: '红牛 (Red Bull)', price: 28, icon: 'fa-bolt' },
             { id: 's8', cat: 'soft', name: '苏打水 (Soda)', price: 20, icon: 'fa-glass-water' },
             { id: 's9', cat: 'soft', name: '普洱茶 (Aged Puer)', price: 68, icon: 'fa-mug-hot'},
             { id: 's10', cat: 'soft', name: '依云矿泉水 (Evian)', price: 28, icon: 'fa-bottle-droplet'},
             { id: 's11', cat: 'soft', name: '手冲咖啡 (Hand Drip)', price: 58, icon: 'fa-mug-saucer'},
             { id: 's12', cat: 'soft', name: '热托迪 (Hot Toddy)', price: 42, icon: 'fa-mug-saucer'},
             { id: 's13', cat: 'soft', name: '乌龙茶 (Oolong)', price: 32, icon: 'fa-leaf'},
             { id: 's14', cat: 'soft', name: '气泡水 (Sparkling)', price: 28, icon: 'fa-glass-water' },
             { id: 's15', cat: 'soft', name: '鲜榨草莓汁 (Strawberry)', price: 38, icon: 'fa-glass-water' },
             
             // Snacks
             { id: 'f1', cat: 'snack', name: '坚果拼盘 (Nuts)', price: 38, icon: 'fa-bowl-food' },
             { id: 'f2', cat: 'snack', name: '黑巧蛋糕 (Cake)', price: 45, icon: 'fa-cake-candles' },
             { id: 'f3', cat: 'snack', name: '炸鸡块 (Fried Chicken)', price: 48, icon: 'fa-drumstick-bite' },
             { id: 'f4', cat: 'snack', name: '薯条 (Fries)', price: 32, icon: 'fa-utensils' },
             { id: 'f5', cat: 'snack', name: '爆米花 (Popcorn)', price: 28, icon: 'fa-bowl-rice' },
             { id: 'f6', cat: 'snack', name: '薯片 (Chips)', price: 22, icon: 'fa-cookie' },
             { id: 'f7', cat: 'snack', name: '辣条 (Spicy Strips)', price: 18, icon: 'fa-fire' },
             { id: 'f8', cat: 'snack', name: '水果拼盘 (Fruits)', price: 88, icon: 'fa-apple-whole'},
             { id: 'f9', cat: 'snack', name: '西班牙火腿 (Ham)', price: 128, icon: 'fa-bacon' },
             { id: 'f10', cat: 'snack', name: '炸薯角 (Wedges)', price: 35, icon: 'fa-potato' },
             { id: 'f11', cat: 'snack', name: '烟熏三文鱼 (Salmon)', price: 98, icon: 'fa-fish' },
             { id: 'f12', cat: 'snack', name: '手指饼干 (Biscuits)', price: 22, icon: 'fa-cookie-bite' },
             { id: 'f13', cat: 'snack', name: '蔬菜条 (Veggie Sticks)', price: 30, icon: 'fa-carrot' }
        ];

        let currentCategory = 'beer';
        let cartItems = {}; // { id: qty } 

        // Unified function to handle add/remove with UI update
        function updateCart(id, change) {
            const currentQty = cartItems[id] || 0;
            const newQty = currentQty + change;
            
            if (newQty <= 0) {
                delete cartItems[id];
            } else {
                cartItems[id] = newQty;
            }
            
            // Re-render menu to update controls and cart
            renderMenu();
            renderCart();
        }

        function renderVibes() {
            const container = document.getElementById('vibeContainer');
            if(!container) return;

            container.innerHTML = vibes.map(v => `
                <div onclick="window.location.href='4.html?tribe=${v.id}'" class="vibe-card rounded-2xl p-6 relative border flex flex-col justify-between h-[186px] cursor-pointer group ${v.active ? 'vibe-active' : 'vibe-inactive'} hover:scale-[1.02] transition-all duration-300">
                    <div class="flex justify-between items-start z-10">
                        <div class="flex-1">
                            <h3 class="font-bold text-2xl text-white group-hover:text-indigo-300 transition-colors mb-2">${v.name}</h3>
                            <p class="text-sm text-slate-400 font-mono tracking-wide uppercase">${v.sub}</p>
                        </div>
                        <div class="flex flex-col items-end gap-2">
                            <div class="w-3 h-3 rounded-full ${v.active ? 'bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)] animate-pulse' : 'bg-slate-600'}"></div>
                            ${v.active ? '<span class="text-[10px] text-green-400 font-bold uppercase tracking-wider">Live</span>' : '<span class="text-[10px] text-slate-600 uppercase tracking-wider">Offline</span>'}
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between z-10 mt-4">
                        <div class="flex items-center gap-3">
                            <div class="flex -space-x-3">
                                ${v.users > 0 ? getAvatars(v.users) : '<span class="text-xs text-slate-600 italic">暂无成员</span>'}
                            </div>
                            ${v.users > 0 ? `<span class="text-sm text-slate-400 font-medium">${v.users} 位酒友</span>` : ''}
                        </div>
                        <div class="flex items-center gap-2 text-slate-500 group-hover:text-indigo-400 transition-colors">
                            <span class="text-sm font-medium">进入</span>
                            <i class="fa-solid fa-arrow-right-long text-base transform group-hover:translate-x-1 transition-transform"></i>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getAvatars(count) {
            let html = '';
            for(let i=0; i<Math.min(count, 3); i++) {
                html += `<div class="w-9 h-9 rounded-full bg-gradient-to-br from-slate-700 to-slate-800 border-2 border-slate-900 overflow-hidden flex items-center justify-center text-sm text-slate-300 relative z-[${10-i}] shadow-lg">
                            <i class="fa-solid fa-user"></i>
                         </div>`;
            }
            if(count > 3) {
                 html += `<div class="w-9 h-9 rounded-full bg-gradient-to-br from-slate-800 to-slate-900 border-2 border-slate-900 flex items-center justify-center text-sm text-amber-400 font-bold relative z-0 shadow-lg">+${count-3}</div>`;
            }
            return html;
        }

        function renderCategories() {
            const container = document.getElementById('categoryContainer');
            if(!container) return;
            
            // Horizontal Scroll for categories
            container.className = "flex overflow-x-auto gap-2 p-2 w-full items-center no-scrollbar";

            container.innerHTML = MENU_CATEGORIES.map(cat => {
                 const isActive = cat.id === currentCategory;
                 // Style matching 4.html (Glassy/Bordered) but with Amber theme and larger font
                 const activeStyle = isActive 
                    ? `text-amber-400 bg-white/10 border-amber-500/50 shadow-[0_0_10px_rgba(245,158,11,0.2)]` 
                    : 'text-slate-500 border-transparent hover:text-slate-300 hover:bg-white/5';
                 
                 return `
                    <button onclick="switchCategory('${cat.id}')" 
                            class="flex-shrink-0 px-3 py-2 rounded-xl border text-xs sm:text-sm font-bold transition-all duration-300 flex items-center gap-2 group whitespace-nowrap ${activeStyle}">
                        <i class="fa-solid ${cat.icon} text-xs sm:text-sm ${isActive ? 'animate-bounce' : ''}"></i>
                        <span>${cat.name.split('(')[0].trim()}</span>
                    </button>
                 `;
            }).join('');
        }

        function switchCategory(id) {
            currentCategory = id;
            renderCategories();
            renderMenu();
        }

        function renderMenu() {
            const container = document.getElementById('productList');
            if(!container) return;

            const filtered = allDrinks.filter(d => d.cat === currentCategory);
            
            if(filtered.length === 0) {
                 container.innerHTML = `<div class="p-4 text-center text-slate-500 text-xs italic">No items in this category</div>`;
                 return;
            }

            container.innerHTML = filtered.map(d => {
                const qty = cartItems[d.id] || 0;
                // Controls
                let controlsHtml = '';
                if (qty === 0) {
                    controlsHtml = `
                    <button onclick="updateCart('${d.id}', 1); event.stopPropagation();" class="w-6 h-6 rounded-full bg-slate-700 hover:bg-amber-500 text-white flex items-center justify-center transition-all shadow border border-white/20 z-10">
                        <span class="text-sm font-bold leading-none relative top-[-0.5px]">+</span>
                    </button>`;
                } else {
                    controlsHtml = `
                    <div class="flex items-center gap-2" onclick="event.stopPropagation();">
                        <button onclick="updateCart('${d.id}', -1)" class="w-6 h-6 rounded-full bg-slate-800 border border-slate-600 hover:bg-red-900/50 text-slate-400 hover:text-red-400 flex items-center justify-center transition-colors">
                            <span class="text-sm font-bold leading-none relative top-[-1px]">-</span>
                        </button>
                        <span class="text-xs font-bold text-amber-400 font-mono select-none min-w-[12px] text-center">${qty}</span>
                        <button onclick="updateCart('${d.id}', 1)" class="w-6 h-6 rounded-full bg-amber-500 text-slate-900 hover:bg-amber-400 flex items-center justify-center transition-colors shadow-sm">
                            <span class="text-sm font-bold leading-none relative top-[-0.5px]">+</span>
                        </button>
                    </div>`;
                }

                return `
                <div class="group relative rounded-xl border p-2 flex items-center gap-3 transition-all ${qty > 0 ? 'bg-slate-800/80 border-amber-500/50 ring-1 ring-amber-500/30' : 'bg-transparent border-white/5 hover:bg-white/5'}">
                    <div class="w-10 h-10 rounded-lg bg-black/30 flex items-center justify-center text-amber-500 shadow-inner shrink-0">
                        <i class="fa-solid ${d.icon} text-lg group-hover:scale-110 transition-transform"></i>
                    </div>
                    
                    <div class="flex-1 min-w-0">
                        <div class="flex justify-between items-start">
                            <span class="text-xs font-bold text-slate-200 group-hover:text-white truncate">${d.name}</span>
                        </div>
                        <div class="flex justify-between items-center mt-1">
                             <span class="text-[10px] text-amber-500 font-mono">¥${d.price}</span>
                        </div>
                    </div>

                    <!-- Right Controls -->
                    <div class="shrink-0 pl-2">
                        ${controlsHtml}
                    </div>
                </div>`;
            }).join('');
        }

        function renderCart() {
            const totalEl = document.getElementById('cartTotal');
            const cartDetails = document.getElementById('cartDetails');
            
            let total = 0;
            let count = 0;
            let html = '';

            Object.keys(cartItems).forEach(id => {
                const qty = cartItems[id];
                const item = allDrinks.find(d => d.id === id);
                if(item && qty > 0) {
                    total += item.price * qty;
                    count += qty;
                    html += `
                        <div class="flex justify-between items-center text-xs text-slate-300">
                             <span class="truncate pr-2">${item.name} <span class="text-slate-500">x${qty}</span></span>
                             <span class="text-amber-500 font-mono whitespace-nowrap">¥${item.price * qty}</span>
                        </div>
                    `;
                }
            });

            totalEl.innerText = `¥${total.toFixed(2)}`;
            
            if(count > 0 && cartDetails) {
                cartDetails.classList.remove('hidden');
                cartDetails.classList.add('flex');
                cartDetails.innerHTML = html;
            } else if (cartDetails) {
                cartDetails.classList.add('hidden');
                cartDetails.classList.remove('flex');
            }
        }

        // Init
        window.addEventListener('load', () => {
             renderVibes();
             renderCategories();
             renderMenu();
             renderCart();
        });
        
        function checkout() {
            const totalText = document.getElementById('cartTotal').innerText;
            const total = parseFloat(totalText.replace('¥', ''));
            if(total > 0) {
                const btn = document.getElementById('checkoutBtn');
                
                // Save Order
                const orderList = [];
                Object.keys(cartItems).forEach(id => {
                    const item = allDrinks.find(d => d.id === id);
                    if(item) {
                        orderList.push({
                            name: item.name,
                            price: item.price,
                            count: cartItems[id]
                        });
                    }
                });
                localStorage.setItem('currentSessionOrder', JSON.stringify(orderList));

                // UI Feedback
                btn.innerHTML = `<span class="mx-auto flex items-center gap-2"><i class="fa-solid fa-spinner animate-spin"></i> Processing...</span>`;
                setTimeout(() => {
                    window.location.href = '3.html';
                }, 1000);
            }
        }

    </script>

</body></html>